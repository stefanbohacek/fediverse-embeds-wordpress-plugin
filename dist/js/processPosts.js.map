{"version":3,"file":"processPosts.js","names":["fetchData","getPostData","renderPost","dispatchEvent","processPosts","postsEmbeds","document","querySelectorAll","posts","renderedPostElements","post","postData","push","length","Promise","all","map","action","nonce","ftf_fediverse_embeds","JSON","stringify","response","renderedPostElement"],"sources":["processPosts.js"],"sourcesContent":["import { fetchData } from \"./fetchData.js\";\r\nimport { getPostData } from \"./getPostData.js\";\r\nimport { renderPost } from \"./renderPost.js\";\r\nimport { dispatchEvent } from \"./dispatchEvent.js\";\r\n\r\nconst processPosts = async (fn) => {\r\n  const postsEmbeds = document.querySelectorAll('blockquote.ftf-fediverse-post-embed');\r\n  let posts = [];\r\n  let renderedPostElements = [];\r\n\r\n  for (const post of postsEmbeds) {\r\n    const postData = getPostData(post);\r\n    posts.push(postData);\r\n  }\r\n  \r\n  // console.log('post data', posts);\r\n\r\n  if (posts.length){\r\n    await Promise.all(\r\n      posts.map(\r\n        async post => {\r\n      await fetchData({\r\n        action: 'ftf_get_post',\r\n        nonce: ftf_fediverse_embeds.nonce,\r\n        post: JSON.stringify(post)\r\n      }, (response) => {\r\n        // console.log('ftf_get_post', {post, response});\r\n        const renderedPostElement = renderPost(response);\r\n        renderedPostElements.push(renderedPostElement);\r\n      });\r\n    }));\r\n\r\n    dispatchEvent('ftf_fediverse_embeds_posts_processed', renderedPostElements);\r\n  }\r\n};\r\n\r\nexport { processPosts };\r\n"],"mappings":"AAAA,OAASA,SAAS,KAAQ,gBAAgB,CAC1C,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,UAAU,KAAQ,iBAAiB,CAC5C,OAASC,aAAa,KAAQ,oBAAoB,CAElD,KAAM,CAAAC,YAAY,CAAG,KAAAA,CAAA,GAAc,CACjC,KAAM,CAAAC,WAAW,CAAGC,QAAQ,CAACC,gBAAgB,CAAC,qCAAqC,CAAC,CAAC,GACjF,CAAAC,KAAK,CAAG,EAAE,CACVC,oBAAoB,CAAG,EAAE,CAE7B,IAAK,KAAM,CAAAC,IAAI,GAAI,CAAAL,WAAW,CAAE,CAC9B,KAAM,CAAAM,QAAQ,CAAGV,WAAW,CAACS,IAAI,CAAC,CAClCF,KAAK,CAACI,IAAI,CAACD,QAAQ,CACrB,CAEA;AAEIH,KAAK,CAACK,MAAM,GACd,KAAM,CAAAC,OAAO,CAACC,GAAG,CACfP,KAAK,CAACQ,GAAG,CACP,KAAM,CAAAN,IAAI,EAAI,CAChB,KAAM,CAAAV,SAAS,CAAC,CACdiB,MAAM,CAAE,cAAc,CACtBC,KAAK,CAAEC,oBAAoB,CAACD,KAAK,CACjCR,IAAI,CAAEU,IAAI,CAACC,SAAS,CAACX,IAAI,CAC3B,CAAC,CAAGY,QAAQ,EAAK,CACf;AACA,KAAM,CAAAC,mBAAmB,CAAGrB,UAAU,CAACoB,QAAQ,CAAC,CAChDb,oBAAoB,CAACG,IAAI,CAACW,mBAAmB,CAC/C,CAAC,CACH,CAAC,CAAC,CAAC,CAEHpB,aAAa,CAAC,sCAAsC,CAAEM,oBAAoB,CAAC,CAE/E,CAAC,CAED,OAASL,YAAY"}