{"version":3,"file":"processPosts.js","names":["fetchData","getPostData","renderPost","dispatchEvent","processPosts","postsEmbeds","document","querySelectorAll","posts","renderedPostElements","post","postData","push","length","Promise","all","map","action","JSON","stringify","response","renderedPostElement"],"sources":["processPosts.js"],"sourcesContent":["import { fetchData } from \"./fetchData.js\";\nimport { getPostData } from \"./getPostData.js\";\nimport { renderPost } from \"./renderPost.js\";\nimport { dispatchEvent } from \"./dispatchEvent.js\";\n\nconst processPosts = async (fn) => {\n  const postsEmbeds = document.querySelectorAll('blockquote.ftf-fediverse-post-embed');\n  let posts = [];\n  let renderedPostElements = [];\n\n  for (const post of postsEmbeds) {\n    const postData = getPostData(post);\n    posts.push(postData);\n  }\n  \n  // console.log('post data', posts);\n\n  if (posts.length){\n    await Promise.all(\n      posts.map(\n        async post => {\n      await fetchData({\n        action: 'ftf_get_post',\n        post: JSON.stringify(post)\n      }, (response) => {\n        // console.log('ftf_get_post', {post, response});\n        const renderedPostElement = renderPost(response);\n        renderedPostElements.push(renderedPostElement);\n      });\n    }));\n\n    dispatchEvent('ftf_fediverse_embeds_posts_processed', renderedPostElements);\n  }\n};\n\nexport { processPosts };\n"],"mappings":"AAAA,OAASA,SAAS,KAAQ,gBAAgB,CAC1C,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,UAAU,KAAQ,iBAAiB,CAC5C,OAASC,aAAa,KAAQ,oBAAoB,CAElD,KAAM,CAAAC,YAAY,CAAG,KAAAA,CAAA,GAAc,CACjC,KAAM,CAAAC,WAAW,CAAGC,QAAQ,CAACC,gBAAgB,CAAC,qCAAqC,CAAC,CAAC,GACjF,CAAAC,KAAK,CAAG,EAAE,CACVC,oBAAoB,CAAG,EAAE,CAE7B,IAAK,KAAM,CAAAC,IAAI,GAAI,CAAAL,WAAW,CAAE,CAC9B,KAAM,CAAAM,QAAQ,CAAGV,WAAW,CAACS,IAAI,CAAC,CAClCF,KAAK,CAACI,IAAI,CAACD,QAAQ,CACrB,CAEA;AAEIH,KAAK,CAACK,MAAM,GACd,KAAM,CAAAC,OAAO,CAACC,GAAG,CACfP,KAAK,CAACQ,GAAG,CACP,KAAM,CAAAN,IAAI,EAAI,CAChB,KAAM,CAAAV,SAAS,CAAC,CACdiB,MAAM,CAAE,cAAc,CACtBP,IAAI,CAAEQ,IAAI,CAACC,SAAS,CAACT,IAAI,CAC3B,CAAC,CAAGU,QAAQ,EAAK,CACf;AACA,KAAM,CAAAC,mBAAmB,CAAGnB,UAAU,CAACkB,QAAQ,CAAC,CAChDX,oBAAoB,CAACG,IAAI,CAACS,mBAAmB,CAC/C,CAAC,CACH,CAAC,CAAC,CAAC,CAEHlB,aAAa,CAAC,sCAAsC,CAAEM,oBAAoB,CAAC,CAE/E,CAAC,CAED,OAASL,YAAY"}